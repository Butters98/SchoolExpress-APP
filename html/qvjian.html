<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>Hello APP</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />
    <link rel="stylesheet" type="text/css" href="../css/common.css" />

    <style>
        html,body{height:100%;background-color: #eee;}
        .h10 {height: 10px;}

        /* 头部导航样式 */
        .header {position: relative;height: 50px;line-height: 50px;background-color: #3993cf;}
        .header .left  {position: absolute;left: 0;height: 50px;}
        .header .left  .logoleft {height: 20px;vertical-align: top; margin-top: 15px;}
        .header .left  .logo {height: 46px; vertical-align: top; margin-top: 2px; margin-left: -10px;}
        .header .left  .title {font-size: 20px; color: #fff; margin-left: -10px;padding-right: 10px;}

        .header .right {position: absolute;right: 0;height: 50px;}
        .header .right img {height: 30px;padding: 10px;}


        /* framegroup 头部样式 */
        .navbar {display: -webkit-box; -webkit-box-orient: horizontal; position: relative; height: 50px; box-sizing: border-box; background: #3F4147; border-bottom: 1px solid #e0e0e0; }
        .navbar-item {display: block; -webkit-box-flex: 1; width: 100%; line-height: 50px; /*color: rgb(148,127,119);*/ font-size: 18px; text-align: center;color: #7E7E7E; }
        .navbar-item-hov {color: #fff; }
        .navbar-item-active {color: #fff; }
        #navmark {position: absolute; left: 0px; bottom: 0px; -webkit-transition: 300ms; text-align: center; background-color: #3993CF;height: 3px;}

        input {height: 50px;font-size: 18px;color: #8E8C8C;width: 80%;outline: none;}
        input::-webkit-input-placeholder {color: #ccc;}
        .divider {height: 15px;}
        .email,.passwd {/*margin-top: 3px;*/background: #fff;}
        .passwd img, .email img {vertical-align: top;}
        .item {background-color: #fff; border-bottom: 1px solid #e0e0e0;position: relative;padding-left: 10px;margin: 0 10px;}
        /*.email, .passwd, .btn {margin:3px 10px;}*/
        .btn {margin:3px 10px;}
        .btn {background: #4DC060;height: 40px; text-align: center; line-height: 40px; font-size: 20px;margin-top: 20px;border-radius: 5px;}
        .btn span {color: #fff;}
        .email img {width: 25px; margin-top: 15px; margin-left: 10px; margin-right: 9px;}
        .passwd img {height: 25px;margin-top: 10px; margin-left: 10px;margin-right: 10px;}
        .secretword img {height: 25px;margin-top: 10px; margin-left: 10px;margin-right: 10px;}


        /* 悬浮样式 */
        .itemhover {background-color: #eee !important;}
        .headerhover {background-color: #36A8DC;}
    </style>
</head>
<body>
    <div class="header" id="topbar">
       <div class="left" tapmode onclick="goback()">
            <img src="../image/abc_ic_ab_back_holo_dark.png" alt="" class="logoleft"><img src="../image/m_drawer_icon_home_selected.png" alt="" class="logo">
            <span class="title">取件信息</span>
        </div>

    </div>


    <form action="">
      <div class="item expressname"><input type="text" placeholder="快递公司名称" id="expressname"></div>
      <div class="item expressnum"><input type="text" placeholder="快递号" id="expressnum">
      </div>
  <div class="item name"><input type="text" placeholder="取件姓名" id="name"></div>
    <div class="item dormnum"><input type="text" placeholder="宿舍号" id="dormnum"></div>
      <div class="item phonenumber"><input type="text" placeholder="手机号" id="phonenum"></div>
      <div class="item remark"><input type="text" placeholder="备注(快递大小,支付金额)" id="remark"></div>
      <div class="btn" onclick="submit()" tapmode="submit-hover"><span type="submit">提交</span></div>

    </form>



</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript">
    function goback () {
        api.closeWin({name:'qvjian'});

    }

    apiready = function() {

      var model=api.require('model');
      var query=api.require('query');
      model.config
      model.config({
          appKey: '4BF88D16-1037-058A-538A-FDD73D844EB6',
          host: 'https://d.apicloud.com'
      });



    };

function submit(){
  api.showProgress({
      style: 'default',
      animationType: 'fade',
      title: '努力提交中...',
      text: '先喝杯茶...',
      modal: false
  });
var user_id=$api.getStorage('user_id');
  var model=api.require('model');
  model.insert
  model.insert({
      class: 'message',
      value: {
          expressname:$api.byId('expressname').value,
            expressnum:$api.byId('expressnum').value,
                name:$api.byId('name').value,
                dormnum:$api.byId('dormnum').value,
                phonenum:$api.byId('phonenum').value,
                  remark:$api.byId('remark').value,
                    userid:user_id
      }
  },function(ret,err){

          model.insert
          model.insert({
              class: 'received_message',
              value: {
                  expressname:$api.byId('expressname').value,
                    expressnum:$api.byId('expressnum').value,
                        name:$api.byId('name').value,
                        dormnum:$api.byId('dormnum').value,
                        phonenum:$api.byId('phonenum').value,
                          remark:$api.byId('remark').value,
                            userid:user_id
              }
          },function(ret,err){
                    
          });
        localStorage.setItem('qvjian',ret.id);
        api.execScript({
            name: 'orderlist',

            script: 'shuaxin();'
        });

        api.alert({
            title: '提交成功',
            msg: '确定',
        }, function(ret, err){
            if( ret ){
              if( ret.buttonIndex==1 ){
                   api.closeWin();
            }else{
                 alert( JSON.stringify( err ) );
            }
          }
        });

  });


}


</script>
</html>
